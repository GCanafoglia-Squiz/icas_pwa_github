{"version":3,"sources":["source/js/global.js","source/modules/header/js/global.js","source/modules/topics/js/global.js"],"names":["$","removeClass","addClass","document","ready","on","toggleClass","length","getCategories","user","e","preventDefault","$this","destination","data","each","hasClass","toAdd","push","setCategories","window","location","href","assetId","js_api","getMetadata","storeToArray","object","arrayCategories","split","console","log","category","indexOf","acquireLock","setAssetMetadata","errorMessage","setStringCategories","join","setMetadata","releaseLock"],"mappings":"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","file":"global.js","sourcesContent":["/*global jQuery*/\n/**\n * {{name}}\n * Global JS\n *\n * version: {{version}}\n * file:    {{file}}\n * author:  Squiz Australia\n * change log:\n *     {{date}} - First revision\n */\n\n/*\n * Table of Contents\n *\n * - Global\n * - Modules\n{{toc}}\n */\n'use strict';\n/*\n--------------------\nGlobal\n--------------------\n*/\n//  Declare JS Enabled.\n$('body').removeClass('no-js').addClass('js-enabled');\n\n\n/*\n--------------------\nModules\n--------------------\n*/\n","$(document).ready(function () {\n  $('.menutrigger').on('click', function() {\n    $('.slide_in_menu').toggleClass('slide_in_menu_open');\n  })\n});","// this part is in Matrix start\n// this part will be in the pain layout of the page\n//\n// var options = new Array();\n// options['key'] = '9400745924';\n// var js_api = new Squiz_Matrix_API(options);\n// var user = 448785 ; //user ID\n// var arrayCategories = [];\n// var toAdd = [];\n//\n//\n// this part is in Matrix end\n\n\n\n// const arrayCategories = [111111, 333333, 444444, 777777, 181818, 212121];\n// const toAdd = [];\n\n$(document).ready(function () {\n  if ($('.topics').length > 0) {\n    // console.log('topics');\n    // console.log('start categories ' + arrayCategories);\n    // console.log('start taAdd ' + toAdd);\n\n    //apply active class to subscribed categories\n    getCategories(user);\n\n    // add/remove category on Click\n    $('ul.topics-list .topics-list__item').on('click', function (e) {\n      e.preventDefault();\n      let $this = $(this);\n      $this.toggleClass('active');\n    });\n\n    //submit selections\n    $('.nextButton p').on('click', function(e){\n      e.preventDefault();\n      let $this = $(this);\n      let destination = $this.data('destinationurl');\n      $('ul.topics-list .topics-list__item').each(function () {\n          if ($(this).hasClass('active')) {\n            // console.log($(this).data('subscription'));\n            toAdd.push($(this).data('subscription'));\n          }\n      });\n      // console.log('end toAdd ' + toAdd);\n      setCategories(user);\n\n      window.location.href = destination;\n    });\n  }\n});\n\n//get metadata and apply active class accordingly\nfunction getCategories(assetId) {\n  js_api.getMetadata({\n    \"asset_id\": assetId,\n    \"dataCallback\": storeToArray\n  });\n  function storeToArray(object) {\n    arrayCategories = object[\"Selected.Topics\"].split('; ');\n    console.log(arrayCategories);\n    $('ul.topics-list .topics-list__item').each(function () {\n      let $this = $(this);\n      let category = $this.data('subscription');\n      if (arrayCategories.indexOf(category) != -1) {\n        $this.addClass('active');\n      }\n    });\n  }\n}\n\n//acquire lock, save metadata, relase lock\nfunction setCategories(assetId) {\n  console.log(\"acquire lock on #\" + assetId );\n  js_api.acquireLock({\n    \"asset_id\": assetId,\n    \"dependants_only\":0,\n    \"force_acquire\":true,\n    \"dataCallback\": setAssetMetadata\n  });\n  function setAssetMetadata(object) {\n    console.log(object);\n    if (object[0][\"warning\"]) {\n      errorMessage();\n    } else {\n      var setStringCategories = toAdd.join('; ');\n      console.log(setStringCategories);\n      js_api.setMetadata({\n        \"asset_id\":assetId,\n        \"field_id\":448763,\n        \"field_val\": setStringCategories ,\n        \"dataCallback\":function() {\n          releaseLock(assetId);\n        }\n      });\n    }\n  }\n  function releaseLock(assetId) {\n    console.log(\"relese lock on #\" + assetId );\n    js_api.releaseLock({\n      \"asset_id\":assetId //,\n      // \"dataCallback\":logToConsole\n    });\n  }\n}"]}