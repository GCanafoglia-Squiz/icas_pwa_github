{"version":3,"sources":["source/js/global.js","source/modules/header/js/global.js","source/modules/topics/js/global.js"],"names":["$","removeClass","addClass","document","ready","on","toggleClass","length","getCategories","user","e","preventDefault","$this","destination","attr","each","hasClass","toAdd","push","data","setCategories","assetId","js_api","getMetadata","storeToArray","object","arrayCategories","split","category","toString","indexOf","urlDestination","acquireLock","setAssetMetadata","consolelog","console","log","setStringCategories","join","setMetadata","releaseLock","redirect","window","location","href"],"mappings":"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","file":"global.js","sourcesContent":["/*global jQuery*/\n/**\n * {{name}}\n * Global JS\n *\n * version: {{version}}\n * file:    {{file}}\n * author:  Squiz Australia\n * change log:\n *     {{date}} - First revision\n */\n\n/*\n * Table of Contents\n *\n * - Global\n * - Modules\n{{toc}}\n */\n'use strict';\n/*\n--------------------\nGlobal\n--------------------\n*/\n//  Declare JS Enabled.\n$('body').removeClass('no-js').addClass('js-enabled');\n\n\n/*\n--------------------\nModules\n--------------------\n*/\n","$(document).ready(function () {\n  $('.menutrigger').on('click', function() {\n    $('.slide_in_menu').toggleClass('slide_in_menu_open');\n  })\n});","// this part is in Matrix start\n// this part will be in the pain layout of the page\n//\n// var options = new Array();\n// options['key'] = '9400745924';\n// var js_api = new Squiz_Matrix_API(options);\n// var user = 448785 ; //user ID\n// var arrayCategories = [];\n// var toAdd = [];\n//\n//\n// this part is in Matrix end\n\n\n\n// const arrayCategories = [111111, 333333, 444444, 777777, 181818, 212121];\n// const toAdd = [];\n\n$(document).ready(function () {\n  if ($('.topics').length > 0) {\n\n    //apply active class to subscribed categories\n    getCategories(user);\n\n    // add/remove category on Click\n    $('ul.topics-list .topics-list__item').on('click', function (e) {\n      e.preventDefault();\n      let $this = $(this);\n      $this.toggleClass('active');\n    });\n\n    //submit selections\n    $('.nextButton a').on('click', function(e){\n      e.preventDefault();\n      let $this = $(this);\n      let destination = $this.attr('href');\n      $('ul.topics-list .topics-list__item').each(function () {\n        if ($(this).hasClass('active')) {\n          toAdd.push($(this).data('subscription'));\n        }\n      });\n      setCategories(user, destination);\n    });\n  }\n});\n\n//get metadata and apply active class accordingly\nfunction getCategories(assetId) {\n  js_api.getMetadata({\n    \"asset_id\": assetId,\n    \"dataCallback\": storeToArray\n  });\n  function storeToArray(object) {\n    if(object[\"Selected.Topics\"]  ) {\n      arrayCategories = object[\"Selected.Topics\"].split('; ');\n      $('ul.topics-list .topics-list__item').each(function () {\n        let $this = $(this);\n        let category = $this.data('subscription').toString();\n        if (arrayCategories.indexOf(category) != -1) {\n          $this.addClass('active');\n        }\n      });\n    }\n  }\n}\n\n//acquire lock, save metadata, relase lock\nfunction setCategories(assetId, urlDestination) {\n  js_api.acquireLock({\n    \"asset_id\": assetId,\n    \"dependants_only\":0,\n    \"force_acquire\":true,\n    \"dataCallback\": setAssetMetadata\n  });\n  function setAssetMetadata(object) {\n    consolelog('seta metadata. object:');\n    console.log(object);\n    if ( object[0][\"warning\"] || object[\"errorCode\"] == \"permissionError\") {\n      console.log('An error has occurred, maybe you are offline. please try again later.');\n    }  else {\n      var setStringCategories = toAdd.join('; ');\n      js_api.setMetadata({\n        \"asset_id\":assetId,\n        \"field_id\":448763,\n        \"field_val\": setStringCategories ,\n        \"dataCallback\":function() {\n          releaseLock(assetId);\n        }\n      });\n    }\n  }\n  function releaseLock(assetId) {\n    js_api.releaseLock({\n      \"asset_id\":assetId,\n      \"dataCallback\":redirect\n    });\n  }\n  function redirect() {\n    window.location.href = urlDestination;\n  }\n}"]}